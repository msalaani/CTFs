#!/usr/bin/env python3

"""

Author : msalaani
Task : Look - Challenge
Event : Hackfest 7 - Finals

"""

from Crypto.Util.number import *
import random

try:
	from secret import FLAG
except ImportError:
    FLAG = b"HACKFEST{DuMmy Flag for Dummy .... test}"

def encrypt(n, P, N, Q = 1):
	if n == 0:
		return 2
	if n == 1:
		return P
	return (P*encrypt(n-1, P, N, Q) - Q*encrypt(n-2, P, N, Q)) % N

if __name__ == "__main__" :
    nbits = 2048
    p, q = [getPrime(nbits >> 2) for _ in '01']
    N = p * q
    e = 3
    Look = encrypt(e, bytes_to_long(FLAG) * (1 << 72) + random.randint(1, 1 << 72), N)
    LookAgain = encrypt(e, bytes_to_long(FLAG) * (1 << 72) + random.randint(1, 1 << 72), N)

    print(f"{N = }")
    print(f"{e = }")
    print(f"{Look = }")
    print(f"{LookAgain = }")

    """
    N = 139660928066306041190911255089657582322026916219817003925853675886658342887850152668752823837070132837972500627214382143759117327008827265412675952727746883124678669857216850083060654667389570840882373986063346595495519746667420703863779656943191065087444757438383690176674151388797091126088869184624328713891
    e = 3
    Look = 7716708646526522410471072042125617057022881467794853321110639152515592856797066989257371659360826879287797590860754878446282931547209457728229755466946379141593677456865466689555908355287519250833997420155478916525628959249476105898858377077705424810134553811506559667642877044101803030859961051331733728552
    LookAgain = 57601329165087944936257582219449732986661463160853015318583381834887767231734978305263082689971591941398842334586993412616019709698488743527800679986869465725120565923385315598175081982476760294330392471431048911455345248730594417489220713269852059655034177061204343340147823363437650089286103040756254141761
    """

