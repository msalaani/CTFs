#!/usr/bin/env python3

"""
Author : msalaani
Task : ALO - Solver
Event : Hackfest 7 - Finals

"""

from Crypto.Util.number import *

# RSA Key Generation in the YKLM-scheme
# (https://link.springer.com/chapter/10.1007/3-540-45861-1_30

# Attack idea
# https://d-nb.info/972386416/34

N = 23363935137344483353733262296348575835678986382439706154867616989755557256749522296165312318432744608191998212908880541706398529459612958847305318119063424989650069305720247016454173658252530786993317517416516937522766370586672046181428717360426752651185135904203763124924228028269794529577135862229390613981708399846746515578407021092362193022321283649269758430826426912018403772987909080831587409043756549961732337350986531309208954792531751221066464963508460916821669548735279698294874779294988065267902817417574486388338558938798815719664692977027627294701666661057662645829351084251612583633811815509729244951959
e = 19896001657109463527367318684911777345391264108657660087730368275639388504416548873099390391246657107610935013853835181718915205603834014142097312757248012060459997853386285299128280163516391320083574804774024108795912017181767148942756935809139831634833626417257948296588839462279484322994041915613747699839508582478366988247571921732724141120678791613633455498995541705574884327318386033304326074899287394838395248595009998500302608489385117617030358401059445066918752704119502333855441056413605740917933193602054208284650271502610476267375971669491799769291510598610284563866903650965565604391151143228767610953565
er = 9034704768734913289519501303287123544276435610469565199890298412992673554470875201053071544461725799914314398644334424626124897870980169578772609138526101
r = 12556985330967823995452854096332851070180093634551763787051619566678038869467276193050301184675923010833886361770342307285401344824413988488786567276565176
c = 8578112741866109306815788427765435260611923647438062592213545557800419014188509832255323596180057466773022838305225441268706381891991168096979400544889071761616978886552774696592772342389507333924884401643435892596989743802249144431353754968305422834907187671053609810668372873344247960330810051016788347962931386374974125541745853475125560672605359668509452812074073071714698784006086443017855453350240452759328008617266958542937107098552863783724673233483533309171865774678304865896604090344717423274556068040153489657048847807459061404701966908117310020430978216882733195312506559702661962043708957885523344441453

k_phi = e*(1 + er * r) - er

d_ = inverse(e, k_phi)
FLAG = int(pow(c, d_, N))

assert long_to_bytes(FLAG) == b"HACKFEST{B6902C2ceb244d94aeF6137ED3944BEEd664169bdBf6204d66Cf009D0029863a}"
